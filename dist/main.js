(()=>{"use strict";const e=(e,r)=>{let t=!1;if(JSON.stringify(e)===JSON.stringify(r)&&(t=!0),void 0===e)return t;if(void 0===r)return t;for(let s=0;s<e.length;s++){const n=e[s];JSON.stringify(n)===JSON.stringify(r)&&(t=!0)}return t},r=(()=>{const r=(e,r,t)=>{let s=r;const n=e;return{isSunk:()=>n===s,hit:()=>s++,currentHits:()=>s,currentCords:t,shipLength:n}};return{Ship:r,Gameboard:()=>{const t=[],s=[];return{receiveAttack:(r,n)=>{const c=Object.entries(n.coordinates);t.push(r);for(let t=0;t<c.length;t++){let i=!1;const o=c[t][1],a=c[t][0];if(e(o,r)&&(i=!0,s.push(r),"carrier"===a&&n.carrier.hit(),"battleShip"===a&&n.battleShip.hit(),"battleShip1"===a&&n.battleShip1.hit(),"cruiser"===a&&n.cruiser.hit(),"cruiser1"===a&&n.cruiser1.hit(),"cruiser2"===a&&n.cruiser2.hit(),"destroyer"===a&&n.destroyer.hit(),"destroyer1"===a&&n.destroyer1.hit(),"destroyer2"===a&&n.destroyer2.hit(),"destroyer3"===a&&n.destroyer3.hit()),!0===i)break}},deployShips:(e,t,s,n,c,i,o,a,d,l)=>{const u={carrier:e,battleShip:t,battleShip1:s,cruiser:n,cruiser1:c,cruiser2:i,destroyer:o,destroyer1:a,destroyer2:d,destroyer3:l};return{carrier:r(4,0,u.carrier),battleShip:r(3,0,u.battleShip),battleShip1:r(3,0,u.battleShip1),cruiser:r(2,0,u.cruiser),cruiser1:r(2,0,u.cruiser1),cruiser2:r(2,0,u.cruiser2),destroyer:r(1,0,u.destroyer),destroyer1:r(1,0,u.destroyer1),destroyer2:r(1,0,u.destroyer2),destroyer3:r(1,0,u.destroyer3),coordinates:u}},receivedAttacks:t,successAttacks:s,checkSunk:e=>{return!((r=e).carrier.currentCords&&!r.carrier.isSunk()||r.battleShip.currentCords&&!r.battleShip.isSunk()||r.battleShip1.currentCords&&!r.battleShip1.isSunk()||r.cruiser.currentCords&&!r.cruiser.isSunk()||r.cruiser1.currentCords&&!r.cruiser1.isSunk()||r.cruiser2.currentCords&&!r.cruiser2.isSunk()||r.destroyer.currentCords&&!r.destroyer.isSunk()||r.destroyer1.currentCords&&!r.destroyer1.isSunk()||r.destroyer2.currentCords&&!r.destroyer2.isSunk()||r.destroyer3.currentCords&&!r.destroyer3.isSunk());var r}}}}})(),t=(e,t)=>{const s=e,n=r.Gameboard(),c=n.deployShips(...t);return{playerName:s,playerBoard:n,playerShips:c,receiveAttack:e=>n.receiveAttack(e,c)}},s=(t,s)=>{const n=t,c=r.Gameboard(),i=c.deployShips(...s),o=[],a=r=>{const t=e=>Math.floor(Math.random()*e),s=[t(9),t(9)];return e(o,r)||e(o,s)?a():r?n.receiveAttack(s):(o.push(r),n.receiveAttack(r))};return{attackPlayer:a,cpuBoard:c,cpuShips:i,receiveAttack:e=>c.receiveAttack(e,i)}},n=(e,r,n)=>{const c=t(e,r);return{Player:c,cpuPlayer:s(c,n)}},c={startGame:(r,t,s,c)=>{const i=n("example",s,c);return r&&t&&((r,t,s)=>{const n=s.Player.playerShips.coordinates,c=s.cpuPlayer.cpuShips.coordinates,i=e=>s.Player.receiveAttack(e),o=e=>s.cpuPlayer.receiveAttack(e),a=(r,t,s)=>{let n=!1;if(e(Object.values(r),t))return s(t),n=!0,!0;for(let c=0;c<r.length;c++){const i=r[c];if(e(i,t)){s(t),n=!0;break}}return n},d=(e,r)=>(r(e),!1),l=(e,r)=>{e.target.textContent=!1===r?"â€¢":"X"},u=e=>{const r=e.target.parentElement.className,t=(e=>{const r=[],t=e.slice(0,1),s=e.slice(2,3);return r.push(Number(t)),r.push(Number(s)),r})(e.target.className);if("grid-1"===r){const e=Object.values(n).filter((e=>void 0!==e));return!0===a(e,t,i)||d(t,i)}if("grid-2"===r){const e=Object.values(c).filter((e=>void 0!==e));return!0===a(e,t,o)||d(t,o)}};for(let e=0;e<r.length;e++)r[e].addEventListener("click",(e=>{!1===u(e)?l(e,!1):l(e,!0)})),t[e].addEventListener("click",(e=>{!1===u(e)?l(e,!1):l(e,!0)}))})(r.childNodes,t.childNodes,i),{currentGame:i,gridContainer1:r,gridContainer2:t}},displayGrid:(e,r)=>{(t=>{const s=t=>{if(10!==t){for(let s=0;s<10;s++){const n=document.createElement("div");n.className=`${t},${s}`;const c=document.createElement("div");c.className=`${t},${s}`,e&&e.appendChild(n),r&&r.appendChild(c)}s(t+1)}};s(0)})()},genDOMElements:()=>{const e=(e,r)=>{const t=document.getElementsByClassName(e)[r-1];t&&(t.style.border="1px solid green")};return{genGrid:(r,t)=>{const s=document.createElement("section");s.className="grids-container";const n=document.querySelector("main");n&&n.appendChild(s);const i=document.createElement("h3");i.textContent=`Player's ${r} Grid`,s.appendChild(i);const o=document.createElement("div");if(o.className=`grid-${r}`,s.appendChild(o),1===r?c.displayGrid(o,null):c.displayGrid(null,o),t){const n=document.createElement("button");n.className="start-button",s.appendChild(n),n.textContent="Start Game",((r,t)=>{const s=(e=>{const r=[];for(let t=0;t<e.length;t++){const s=e[t];"object"==typeof s[0]?r.push(...s):r.push(s)}return r})(r);for(let r=0;r<s.length;r++)e(`${(n=s[r]).slice(0,1)},${n.slice(1,2)}`,t);var n})(t,r)}return o},deleteElements:()=>{const e=document.getElementsByClassName("grids-container")[0];e&&e.remove()}}}};(()=>{const e=[[[0,1],[0,2],[0,3],[0,4]],[[2,1],[3,1],[4,1]],[[0,6],[0,7],[0,8]],[[3,3],[3,4]],[[6,3],[6,2]],[[6,8],[6,9]],[7,5],[9,2],[9,9],[8,7]],r=c.genDOMElements(),t=()=>{const t=c.startGame(r.genGrid(1),r.genGrid(2),e,e);r.deleteElements();const s=t.currentGame.Player,n=t.currentGame.cpuPlayer;return((e,r,t,s)=>{for(let e=0;e<s.childNodes.length;e++)s.childNodes[e].addEventListener("click",t.turnsLogic)})(0,0,((e,r)=>{let t=0;return{turnsLogic:()=>{e.cpuBoard.receivedAttacks.length===t+1&&(t++,e.attackPlayer(r))}}})(n,e),t.gridContainer2),{playerObj:s,cpuObj:n}};return{singlePlayer:t,setupDOM:()=>{r.genGrid(1,e);const s=document.getElementsByClassName("start-button")[0];s&&s.addEventListener("click",t)}}})().setupDOM()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoibUJBQUEsTUFBTUEsRUFBa0IsQ0FBQ0MsRUFBS0MsS0FDNUIsSUFBSUMsR0FBVyxFQUlmLEdBRklDLEtBQUtDLFVBQVVKLEtBQVNHLEtBQUtDLFVBQVVILEtBQVNDLEdBQVcsUUFFbkRHLElBQVJMLEVBQW1CLE9BQU9FLEVBRTlCLFFBQWVHLElBQVhKLEVBQXNCLE9BQU9DLEVBRWpDLElBQUssSUFBSUksRUFBSSxFQUFHQSxFQUFJTixFQUFJTyxPQUFRRCxJQUFLLENBQ25DLE1BQU1FLEVBQVVSLEVBQUlNLEdBRWhCSCxLQUFLQyxVQUFVSSxLQUFhTCxLQUFLQyxVQUFVSCxLQUFTQyxHQUFXLEVBQ3JFLENBRUEsT0FBT0EsQ0FBUSxFQUdYTyxFQUFjLE1BQ2xCLE1BQU1DLEVBQU8sQ0FBQ0MsRUFBY0MsRUFBWUMsS0FRdEMsSUFBSUMsRUFBV0YsRUFFZixNQUFNRyxFQUFhSixFQVFuQixNQUFPLENBQUVLLE9BTk0sSUFBZ0JELElBQVlELEVBTTFCRyxJQUpMLElBQU1ILElBSUlJLFlBRkYsSUFBTUosRUFFU0ssYUFqQmROLEVBaUI0QkUsYUFBWSxFQStJL0QsTUFBTyxDQUFFTCxPQUFNVSxVQTVJRyxLQUNoQixNQTRETUMsRUFBa0IsR0FFbEJDLEVBQWlCLEdBb0V2QixNQUFPLENBQ0xDLGNBbkVvQixDQUFDQyxFQUFhQyxLQUNsQyxNQUFNQyxFQUFlQyxPQUFPQyxRQUFRSCxFQUFZSSxhQUNoRFIsRUFBZ0JTLEtBQUtOLEdBRXJCLElBQUssSUFBSWxCLEVBQUksRUFBR0EsRUFBSW9CLEVBQWFuQixPQUFRRCxJQUFLLENBQzVDLElBQUl5QixHQUFVLEVBRWQsTUFBTUMsRUFBWU4sRUFBYXBCLEdBQUcsR0FFNUIyQixFQUFXUCxFQUFhcEIsR0FBRyxHQW9CakMsR0FsQklQLEVBQWdCaUMsRUFBV1IsS0FDN0JPLEdBQVUsRUFFVlQsRUFBZVEsS0FBS04sR0FHSCxZQUFiUyxHQUF3QlIsRUFBWVMsUUFBUWpCLE1BQy9CLGVBQWJnQixHQUEyQlIsRUFBWVUsV0FBV2xCLE1BQ3JDLGdCQUFiZ0IsR0FBNEJSLEVBQVlXLFlBQVluQixNQUN2QyxZQUFiZ0IsR0FBd0JSLEVBQVlZLFFBQVFwQixNQUMvQixhQUFiZ0IsR0FBeUJSLEVBQVlhLFNBQVNyQixNQUNqQyxhQUFiZ0IsR0FBeUJSLEVBQVljLFNBQVN0QixNQUNqQyxjQUFiZ0IsR0FBMEJSLEVBQVllLFVBQVV2QixNQUNuQyxlQUFiZ0IsR0FBMkJSLEVBQVlnQixXQUFXeEIsTUFDckMsZUFBYmdCLEdBQTJCUixFQUFZaUIsV0FBV3pCLE1BQ3JDLGVBQWJnQixHQUEyQlIsRUFBWWtCLFdBQVcxQixRQUd4QyxJQUFaYyxFQUFrQixLQUN4QixHQXNDQWEsWUFwSWtCLENBQ2xCQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxFQUNBQyxLQUVBLE1BQU16QixFQUFjLENBQ2xCSyxRQUFTVyxFQUNUVixXQUFZVyxFQUNaVixZQUFhVyxFQUNiVixRQUFTVyxFQUNUVixTQUFVVyxFQUNWVixTQUFVVyxFQUNWVixVQUFXVyxFQUNYVixXQUFZVyxFQUNaVixXQUFZVyxFQUNaVixXQUFZVyxHQXVCZCxNQUFPLENBQ0xwQixRQXJCY3hCLEVBQUssRUFBRyxFQUFHbUIsRUFBWUssU0FzQnJDQyxXQXBCaUJ6QixFQUFLLEVBQUcsRUFBR21CLEVBQVlNLFlBcUJ4Q0MsWUFuQmtCMUIsRUFBSyxFQUFHLEVBQUdtQixFQUFZTyxhQW9CekNDLFFBbEJjM0IsRUFBSyxFQUFHLEVBQUdtQixFQUFZUSxTQW1CckNDLFNBakJlNUIsRUFBSyxFQUFHLEVBQUdtQixFQUFZUyxVQWtCdENDLFNBaEJlN0IsRUFBSyxFQUFHLEVBQUdtQixFQUFZVSxVQWlCdENDLFVBZmdCOUIsRUFBSyxFQUFHLEVBQUdtQixFQUFZVyxXQWdCdkNDLFdBZGlCL0IsRUFBSyxFQUFHLEVBQUdtQixFQUFZWSxZQWV4Q0MsV0FiaUJoQyxFQUFLLEVBQUcsRUFBR21CLEVBQVlhLFlBY3hDQyxXQVppQmpDLEVBQUssRUFBRyxFQUFHbUIsRUFBWWMsWUFheENkLGNBQ0QsRUE0RURSLGtCQUNBQyxpQkFDQWlDLFVBdENpQjlCLElBOEJqQixTQTdCb0IrQixFQTZCRi9CLEdBMUJOUyxRQUFRZixlQUNkcUMsRUFBTXRCLFFBQVFsQixVQUNkd0MsRUFBTXJCLFdBQVdoQixlQUNqQnFDLEVBQU1yQixXQUFXbkIsVUFDakJ3QyxFQUFNcEIsWUFBWWpCLGVBQ2xCcUMsRUFBTXBCLFlBQVlwQixVQUNsQndDLEVBQU1uQixRQUFRbEIsZUFDZHFDLEVBQU1uQixRQUFRckIsVUFDZHdDLEVBQU1sQixTQUFTbkIsZUFDZnFDLEVBQU1sQixTQUFTdEIsVUFDZndDLEVBQU1qQixTQUFTcEIsZUFDZnFDLEVBQU1qQixTQUFTdkIsVUFDZndDLEVBQU1oQixVQUFVckIsZUFDaEJxQyxFQUFNaEIsVUFBVXhCLFVBQ2hCd0MsRUFBTWYsV0FBV3RCLGVBQ2pCcUMsRUFBTWYsV0FBV3pCLFVBQ2pCd0MsRUFBTWQsV0FBV3ZCLGVBQ2pCcUMsRUFBTWQsV0FBVzFCLFVBQ2pCd0MsRUFBTWIsV0FBV3hCLGVBQ2pCcUMsRUFBTWIsV0FBVzNCLFVBdEJKLElBQUN3QyxDQTZCVSxFQVMvQixFQUlKLEVBbkttQixHQXFLZEMsRUFDVyxDQUFDQyxFQUFNQyxLQUNwQixNQUFNQyxFQUFhRixFQUViRyxFQUFjcEQsRUFBWVcsWUFFMUJLLEVBQWNvQyxFQUFZakIsZUFBZWUsR0FLL0MsTUFBTyxDQUFFQyxhQUFZQyxjQUFhcEMsY0FBYUYsY0FIeEJNLEdBQ3JCZ0MsRUFBWXRDLGNBQWNNLEVBQWFKLEdBRXFCLEVBWDVEZ0MsRUFjYyxDQUFDSyxFQUFhSCxLQUM5QixNQUFNSSxFQUFjRCxFQUVkRSxFQUFXdkQsRUFBWVcsWUFFdkI2QyxFQUFXRCxFQUFTcEIsZUFBZWUsR0FLbkNPLEVBQWEsR0FFYkMsRUFBZ0J0RCxJQUVwQixNQUFNdUQsRUFBYUMsR0FBUUMsS0FBS0MsTUFBTUQsS0FBS0UsU0FBV0gsR0FFaERJLEVBQWUsQ0FBQ0wsRUFBVSxHQUFJQSxFQUFVLElBRzlDLE9BQUlyRSxFQUFnQm1FLEVBQVlyRCxJQUU1QmQsRUFBZ0JtRSxFQUFZTyxHQUZnQk4sSUFJM0N0RCxFQU1Fa0QsRUFBWXhDLGNBQWNrRCxJQUovQlAsRUFBV3BDLEtBQUtqQixHQUNUa0QsRUFBWXhDLGNBQWNWLEdBR1csRUFHaEQsTUFBTyxDQUFFc0QsZUFBY0gsV0FBVUMsV0FBVTFDLGNBekJwQk0sR0FDckJtQyxFQUFTekMsY0FBY00sRUFBYW9DLEdBd0JvQixFQU14RFMsRUFDWSxDQUFDZCxFQUFZZSxFQUFjQyxLQUN6QyxNQUFNQyxFQUFTcEIsRUFBbUJHLEVBQVllLEdBSTlDLE1BQU8sQ0FBRUUsU0FBUUMsVUFGQ3JCLEVBQXNCb0IsRUFBUUQsR0FFcEIsRUFNMUJHLEVBd09HLENBQUVDLFVBckdTLENBQ2hCQyxFQUNBQyxFQUNBUCxFQUNBQyxLQUVBLE1BQU1PLEVBQWNULEVBQWEsVUFBV0MsRUFBY0MsR0FhMUQsT0FWRUssR0FDQUMsR0FsSFksRUFBQ0UsRUFBUUMsRUFBUUMsS0FDL0IsTUFBTUMsRUFBZ0JELEVBQVNULE9BQU9wRCxZQUFZSSxZQUU1QzJELEVBQWdCRixFQUFTUixVQUFVYixTQUFTcEMsWUFFNUNzQyxFQUFnQnNCLEdBQVVILEVBQVNULE9BQU90RCxjQUFja0UsR0FFeERDLEVBQWFELEdBQVVILEVBQVNSLFVBQVV2RCxjQUFja0UsR0FFeERFLEVBQWdCLENBQUNDLEVBQVlDLEVBQVdDLEtBRTVDLElBQUlDLEdBQWdCLEVBQ3BCLEdBQUloRyxFQUFnQjRCLE9BQU9xRSxPQUFPSixHQUFhQyxHQUk3QyxPQUZBQyxFQUFlRCxHQUNmRSxHQUFnQixHQUNULEVBR1QsSUFBSyxJQUFJekYsRUFBSSxFQUFHQSxFQUFJc0YsRUFBV3JGLE9BQVFELElBQUssQ0FFMUMsTUFBTTJGLEVBQWdCTCxFQUFXdEYsR0FDakMsR0FBSVAsRUFBZ0JrRyxFQUFlSixHQUFZLENBQzdDQyxFQUFlRCxHQUNmRSxHQUFnQixFQUNoQixLQUNGLENBQ0YsQ0FDQSxPQUFPQSxDQUFhLEVBTWhCRyxFQUFzQixDQUFDTCxFQUFXQyxLQUN0Q0EsRUFBZUQsSUFDUixHQWdCSE0sRUFBbUIsQ0FBQ0MsRUFBR0wsS0FDUEssRUFBRW5HLE9BQ21Cb0csYUFBbkIsSUFBbEJOLEVBQW1ELElBRTNCLEdBQzVCLEVBR0lPLEVBQWlCRixJQUNyQixNQUFNRyxFQUFjSCxFQUFFbkcsT0FBT3VHLGNBQWNDLFVBSXJDWixFQTFCYSxDQUFDYSxJQUNwQixNQUFNQyxFQUFhLEdBRWJDLEVBQUlGLEVBQVdHLE1BQU0sRUFBRyxHQUV4QkMsRUFBSUosRUFBV0csTUFBTSxFQUFHLEdBSzlCLE9BSEFGLEVBQVc3RSxLQUFLaUYsT0FBT0gsSUFDdkJELEVBQVc3RSxLQUFLaUYsT0FBT0QsSUFFaEJILENBQVUsRUFnQkNLLENBRkFaLEVBQUVuRyxPQUFPd0csV0FJM0IsR0FBb0IsV0FBaEJGLEVBQTBCLENBRzVCLE1BQU1VLEVBQWN0RixPQUFPcUUsT0FBT1QsR0FBZTJCLFFBQzlDckcsUUFBc0JSLElBQVhRLElBRWQsT0FBNEQsSUFBeEQ4RSxFQUFjc0IsRUFBYXBCLEVBQVcxQixJQUNuQytCLEVBQW9CTCxFQUFXMUIsRUFDeEMsQ0FFQSxHQUFvQixXQUFoQm9DLEVBQTBCLENBQzVCLE1BQU1VLEVBQWN0RixPQUFPcUUsT0FBT1IsR0FBZTBCLFFBQzlDckcsUUFBc0JSLElBQVhRLElBRWQsT0FBeUQsSUFBckQ4RSxFQUFjc0IsRUFBYXBCLEVBQVdILElBQ25DUSxFQUFvQkwsRUFBV0gsRUFDeEMsR0FHRixJQUFLLElBQUlwRixFQUFJLEVBQUdBLEVBQUk4RSxFQUFPN0UsT0FBUUQsSUFDakM4RSxFQUFPOUUsR0FBRzZHLGlCQUFpQixTQUFVZixLQUNWLElBQXJCRSxFQUFjRixHQUNoQkQsRUFBaUJDLEdBQUcsR0FFcEJELEVBQWlCQyxHQUFHLEVBQ3RCLElBRUZmLEVBQU8vRSxHQUFHNkcsaUJBQWlCLFNBQVVmLEtBQ1YsSUFBckJFLEVBQWNGLEdBQ2hCRCxFQUFpQkMsR0FBRyxHQUVwQkQsRUFBaUJDLEdBQUcsRUFDdEIsR0FFSixFQWVFZ0IsQ0FDRW5DLEVBQWVvQyxXQUNmbkMsRUFBZW1DLFdBQ2ZsQyxHQUlHLENBQUVBLGNBQWFGLGlCQUFnQkMsaUJBQWdCLEVBa0ZwQ29DLFlBdk9BLENBQUNDLEVBQU9DLEtBQ1AsQ0FBQ0MsSUFDbEIsTUFBTUMsRUFBYUMsSUFDakIsR0FvQk8sS0FwQkhBLEVBQUosQ0FFQSxJQUFLLElBQUlySCxFQUFJLEVBQUdBLEVBa0JULEdBbEJtQkEsSUFBSyxDQUM3QixNQUFNc0gsRUFBY0MsU0FBU0MsY0FBYyxPQUMzQ0YsRUFBWW5CLFVBQVksR0FBR2tCLEtBQVFySCxJQUVuQyxNQUFNeUgsRUFBZUYsU0FBU0MsY0FBYyxPQUM1Q0MsRUFBYXRCLFVBQVksR0FBR2tCLEtBQVFySCxJQUVoQ2lILEdBQ0ZBLEVBQU1TLFlBQVlKLEdBQ2hCSixHQUNGQSxFQUFNUSxZQUFZRCxFQUN0QixDQUVBTCxFQUFVQyxFQUFPLEVBZlEsQ0FlTixFQUVyQkQsRUFBVSxFQUFFLEVBR2RPLEVBQWMsRUFnTmlCQyxlQS9FVixLQUNyQixNQUVNQyxFQUFtQixDQUFDMUIsRUFBVzJCLEtBQ25DLE1BQU1DLEVBQ0pSLFNBQVNTLHVCQUF1QjdCLEdBQVcyQixFQUFhLEdBRXREQyxJQUNGQSxFQUFhRSxNQUFNQyxPQUFTLGtCQUFpQixFQW9FakQsTUFBTyxDQUFFQyxRQXJDTyxDQUFDQyxFQUFhN0gsS0FFNUIsTUFBTThILEVBQWlCZCxTQUFTQyxjQUFjLFdBQzlDYSxFQUFlbEMsVUFBWSxrQkFFM0IsTUFBTW1DLEVBQU9mLFNBQVNnQixjQUFjLFFBQ2hDRCxHQUNGQSxFQUFLWixZQUFZVyxHQUVuQixNQUFNakYsRUFBT21FLFNBQVNDLGNBQWMsTUFDcENwRSxFQUFLMkMsWUFBYyxZQUFZcUMsU0FDL0JDLEVBQWVYLFlBQVl0RSxHQUUzQixNQUFNb0YsRUFBT2pCLFNBQVNDLGNBQWMsT0FXcEMsR0FWQWdCLEVBQUtyQyxVQUFZLFFBQVFpQyxJQUN6QkMsRUFBZVgsWUFBWWMsR0FFUCxJQUFoQkosRUFDRjNELEVBQVN1QyxZQUFZd0IsRUFBTSxNQUczQi9ELEVBQVN1QyxZQUFZLEtBQU13QixHQUd6QmpJLEVBQVEsQ0FDVixNQUFNa0ksRUFBY2xCLFNBQVNDLGNBQWMsVUFDM0NpQixFQUFZdEMsVUFBWSxlQUN4QmtDLEVBQWVYLFlBQVllLEdBQzNCQSxFQUFZMUMsWUFBYyxhQXpDWixFQUFDSixFQUFlbUMsS0FDaEMsTUFBTXZILEVBaEJXLENBQUNtSSxJQUNsQixNQUFNQyxFQUFxQixHQUUzQixJQUFLLElBQUkzSSxFQUFJLEVBQUdBLEVBQUkwSSxFQUFVekksT0FBUUQsSUFBSyxDQUN6QyxNQUFNTyxFQUFTbUksRUFBVTFJLEdBRUEsaUJBQWRPLEVBQU8sR0FDaEJvSSxFQUFtQm5ILFFBQ2RqQixHQUVGb0ksRUFBbUJuSCxLQUFLakIsRUFDL0IsQ0FDQSxPQUFPb0ksQ0FBa0IsRUFJVkMsQ0FBV2pELEdBRTFCLElBQUssSUFBSTNGLEVBQUksRUFBR0EsRUFBSU8sRUFBT04sT0FBUUQsSUFDakM2SCxFQTdCMEIsSUFBUm5JLEVBNkJZYSxFQUFPUCxJQTdCSnVHLE1BQU0sRUFBRyxNQUFNN0csRUFBSTZHLE1BQU0sRUFBRyxLQTZCbkJ1QixHQTdCekIsSUFBQ3BJLENBOEJwQixFQXNDRW1KLENBQVV0SSxFQUFRNkgsRUFDcEIsQ0FFQSxPQUFPSSxDQUFJLEVBSUtNLGVBMUNLLEtBQ3JCLE1BQU1ULEVBQWlCZCxTQUFTUyx1QkFBdUIsbUJBQW1CLEdBQ3RFSyxHQUFnQkEsRUFBZVUsUUFBTyxFQXdDWCxHQU1wQixNQUVmLE1BZU1DLEVBQWdCLENBQ3BCLENBQUMsQ0FBQyxFQUFHLEdBQUksQ0FBQyxFQUFHLEdBQUksQ0FBQyxFQUFHLEdBQUksQ0FBQyxFQUFHLElBQzdCLENBQUMsQ0FBQyxFQUFHLEdBQUksQ0FBQyxFQUFHLEdBQUksQ0FBQyxFQUFHLElBQ3JCLENBQUMsQ0FBQyxFQUFHLEdBQUksQ0FBQyxFQUFHLEdBQUksQ0FBQyxFQUFHLElBQ3JCLENBQUMsQ0FBQyxFQUFHLEdBQUksQ0FBQyxFQUFHLElBQ2IsQ0FBQyxDQUFDLEVBQUcsR0FBSSxDQUFDLEVBQUcsSUFDYixDQUFDLENBQUMsRUFBRyxHQUFJLENBQUMsRUFBRyxJQUNiLENBQUMsRUFBRyxHQUNKLENBQUMsRUFBRyxHQUNKLENBQUMsRUFBRyxHQUNKLENBQUMsRUFBRyxJQUdBQyxFQUFTeEUsRUFBU21ELGlCQUVsQnNCLEVBQWUsS0FFbkIsTUFBTUMsRUFBVTFFLEVBQVNDLFVBQ3ZCdUUsRUFBT2QsUUFBUSxHQUNmYyxFQUFPZCxRQUFRLEdBQ2ZhLEVBQ0FBLEdBR0ZDLEVBQU9ILGlCQUVQLE1BQU1NLEVBQVlELEVBQVF0RSxZQUFZTixPQUNoQzhFLEVBQVNGLEVBQVF0RSxZQUFZTCxVQWdCbkMsTUFWaUIsRUFBQzhFLEVBQVFDLEVBQVNDLEVBQVVDLEtBRTNDLElBQUssSUFBSXpKLEVBQUksRUFBR0EsRUFBSXlKLEVBQVkxQyxXQUFXOUcsT0FBUUQsSUFDcEN5SixFQUFZMUMsV0FBVy9HLEdBQy9CNkcsaUJBQWlCLFFBQVMyQyxFQUFTRSxXQUMxQyxFQUdGQyxDQUFTUCxFQUFXQyxFQXhESixFQUFDRSxFQUFTdEUsS0FFMUIsSUFBSTJFLEVBQXNCLEVBVTFCLE1BQU8sQ0FBRUYsV0FSVSxLQUViSCxFQUFRN0YsU0FBUzNDLGdCQUFnQmQsU0FBVzJKLEVBQXNCLElBQ3BFQSxJQUNBTCxFQUFRMUYsYUFBYW9CLEdBQ3ZCLEVBR2tCLEVBK0JBNEUsQ0FBVVIsRUFBUUwsR0FDdEJHLEVBQVF2RSxnQkFjakIsQ0FBRXdFLFlBQVdDLFNBQU8sRUFnQjdCLE1BQU8sQ0FBRUgsZUFBY1ksU0FaTixLQUVmYixFQUFPZCxRQUFRLEVBQUdhLEdBRWxCLE1BQU1QLEVBQ0psQixTQUFTUyx1QkFBdUIsZ0JBQWdCLEdBRTlDUyxHQUNGQSxFQUFZNUIsaUJBQWlCLFFBQVNxQyxFQUFZLEVBTXZELEVBOUVnQixHQWdGUlksVSIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgaXNUYXJnZXRJbkFycmF5ID0gKGFyciwgdGFyZ2V0KSA9PiB7XG4gIGxldCBjb250YWlucyA9IGZhbHNlO1xuXG4gIGlmIChKU09OLnN0cmluZ2lmeShhcnIpID09PSBKU09OLnN0cmluZ2lmeSh0YXJnZXQpKSBjb250YWlucyA9IHRydWU7XG5cbiAgaWYgKGFyciA9PT0gdW5kZWZpbmVkKSByZXR1cm4gY29udGFpbnM7XG5cbiAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkKSByZXR1cm4gY29udGFpbnM7XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBlbGVtZW50ID0gYXJyW2ldO1xuXG4gICAgaWYgKEpTT04uc3RyaW5naWZ5KGVsZW1lbnQpID09PSBKU09OLnN0cmluZ2lmeSh0YXJnZXQpKSBjb250YWlucyA9IHRydWU7XG4gIH1cblxuICByZXR1cm4gY29udGFpbnM7XG59O1xuXG5jb25zdCBtYWluT2JqZWN0cyA9ICgoKSA9PiB7XG4gIGNvbnN0IFNoaXAgPSAobGVuZ3RoTnVtYmVyLCBoaXRzTnVtYmVyLCBjb29yZHMpID0+IHtcbiAgICBjb25zdCBjdXJyZW50Q29yZHMgPSBjb29yZHM7XG5cbiAgICBjb25zdCBjaGVja1N1bmsgPSAobGVuZ3RoLCBoaXRzKSA9PiB7XG4gICAgICBpZiAobGVuZ3RoID09PSBoaXRzKSByZXR1cm4gdHJ1ZTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgbGV0IHNoaXBIaXRzID0gaGl0c051bWJlcjtcblxuICAgIGNvbnN0IHNoaXBMZW5ndGggPSBsZW5ndGhOdW1iZXI7XG5cbiAgICBjb25zdCBpc1N1bmsgPSAoKSA9PiBjaGVja1N1bmsoc2hpcExlbmd0aCwgc2hpcEhpdHMpO1xuXG4gICAgY29uc3QgaGl0ID0gKCkgPT4gc2hpcEhpdHMrKztcblxuICAgIGNvbnN0IGN1cnJlbnRIaXRzID0gKCkgPT4gc2hpcEhpdHM7XG5cbiAgICByZXR1cm4geyBpc1N1bmssIGhpdCwgY3VycmVudEhpdHMsIGN1cnJlbnRDb3Jkcywgc2hpcExlbmd0aCB9O1xuICB9O1xuXG4gIGNvbnN0IEdhbWVib2FyZCA9ICgpID0+IHtcbiAgICBjb25zdCBkZXBsb3lTaGlwcyA9IChcbiAgICAgIGNhcnJpZXJDb3JkcyxcbiAgICAgIGJhdHRsZVNoaXBDb3JkcyxcbiAgICAgIGJhdHRsZVNoaXAxQ29yZHMsXG4gICAgICBjcnVpc2VyQ29yZHMsXG4gICAgICBjcnVpc2VyMUNvcmRzLFxuICAgICAgY3J1aXNlcjJDb3JkcyxcbiAgICAgIGRlc3Ryb3llckNvcmRzLFxuICAgICAgZGVzdHJveWVyMUNvcmRzLFxuICAgICAgZGVzdHJveWVyMkNvcmRzLFxuICAgICAgZGVzdHJveWVyM0NvcmRzXG4gICAgKSA9PiB7XG4gICAgICBjb25zdCBjb29yZGluYXRlcyA9IHtcbiAgICAgICAgY2FycmllcjogY2FycmllckNvcmRzLFxuICAgICAgICBiYXR0bGVTaGlwOiBiYXR0bGVTaGlwQ29yZHMsXG4gICAgICAgIGJhdHRsZVNoaXAxOiBiYXR0bGVTaGlwMUNvcmRzLFxuICAgICAgICBjcnVpc2VyOiBjcnVpc2VyQ29yZHMsXG4gICAgICAgIGNydWlzZXIxOiBjcnVpc2VyMUNvcmRzLFxuICAgICAgICBjcnVpc2VyMjogY3J1aXNlcjJDb3JkcyxcbiAgICAgICAgZGVzdHJveWVyOiBkZXN0cm95ZXJDb3JkcyxcbiAgICAgICAgZGVzdHJveWVyMTogZGVzdHJveWVyMUNvcmRzLFxuICAgICAgICBkZXN0cm95ZXIyOiBkZXN0cm95ZXIyQ29yZHMsXG4gICAgICAgIGRlc3Ryb3llcjM6IGRlc3Ryb3llcjNDb3JkcyxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGNhcnJpZXIgPSBTaGlwKDQsIDAsIGNvb3JkaW5hdGVzLmNhcnJpZXIpO1xuXG4gICAgICBjb25zdCBiYXR0bGVTaGlwID0gU2hpcCgzLCAwLCBjb29yZGluYXRlcy5iYXR0bGVTaGlwKTtcblxuICAgICAgY29uc3QgYmF0dGxlU2hpcDEgPSBTaGlwKDMsIDAsIGNvb3JkaW5hdGVzLmJhdHRsZVNoaXAxKTtcblxuICAgICAgY29uc3QgY3J1aXNlciA9IFNoaXAoMiwgMCwgY29vcmRpbmF0ZXMuY3J1aXNlcik7XG5cbiAgICAgIGNvbnN0IGNydWlzZXIxID0gU2hpcCgyLCAwLCBjb29yZGluYXRlcy5jcnVpc2VyMSk7XG5cbiAgICAgIGNvbnN0IGNydWlzZXIyID0gU2hpcCgyLCAwLCBjb29yZGluYXRlcy5jcnVpc2VyMik7XG5cbiAgICAgIGNvbnN0IGRlc3Ryb3llciA9IFNoaXAoMSwgMCwgY29vcmRpbmF0ZXMuZGVzdHJveWVyKTtcblxuICAgICAgY29uc3QgZGVzdHJveWVyMSA9IFNoaXAoMSwgMCwgY29vcmRpbmF0ZXMuZGVzdHJveWVyMSk7XG5cbiAgICAgIGNvbnN0IGRlc3Ryb3llcjIgPSBTaGlwKDEsIDAsIGNvb3JkaW5hdGVzLmRlc3Ryb3llcjIpO1xuXG4gICAgICBjb25zdCBkZXN0cm95ZXIzID0gU2hpcCgxLCAwLCBjb29yZGluYXRlcy5kZXN0cm95ZXIzKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY2FycmllcixcbiAgICAgICAgYmF0dGxlU2hpcCxcbiAgICAgICAgYmF0dGxlU2hpcDEsXG4gICAgICAgIGNydWlzZXIsXG4gICAgICAgIGNydWlzZXIxLFxuICAgICAgICBjcnVpc2VyMixcbiAgICAgICAgZGVzdHJveWVyLFxuICAgICAgICBkZXN0cm95ZXIxLFxuICAgICAgICBkZXN0cm95ZXIyLFxuICAgICAgICBkZXN0cm95ZXIzLFxuICAgICAgICBjb29yZGluYXRlcyxcbiAgICAgIH07XG4gICAgfTtcblxuICAgIGNvbnN0IHJlY2VpdmVkQXR0YWNrcyA9IFtdO1xuXG4gICAgY29uc3Qgc3VjY2Vzc0F0dGFja3MgPSBbXTtcblxuICAgIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAodGFyZ2V0Q29yZHMsIHBsYXllclNoaXBzKSA9PiB7XG4gICAgICBjb25zdCBjdXJyZW50U2hpcHMgPSBPYmplY3QuZW50cmllcyhwbGF5ZXJTaGlwcy5jb29yZGluYXRlcyk7XG4gICAgICByZWNlaXZlZEF0dGFja3MucHVzaCh0YXJnZXRDb3JkcylcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjdXJyZW50U2hpcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IHN1Y2Nlc3MgPSBmYWxzZTtcblxuICAgICAgICBjb25zdCBzaGlwQ29yZHMgPSBjdXJyZW50U2hpcHNbaV1bMV07XG5cbiAgICAgICAgY29uc3Qgc2hpcE5hbWUgPSBjdXJyZW50U2hpcHNbaV1bMF07XG5cbiAgICAgICAgaWYgKGlzVGFyZ2V0SW5BcnJheShzaGlwQ29yZHMsIHRhcmdldENvcmRzKSkge1xuICAgICAgICAgIHN1Y2Nlc3MgPSB0cnVlO1xuXG4gICAgICAgICAgc3VjY2Vzc0F0dGFja3MucHVzaCh0YXJnZXRDb3Jkcyk7XG5cbiAgICAgICAgICAvLyBpZiB0aGUgdGFyZ2V0IGNvcmRzIG1hdGNoZXMgYSBzaGlwIGNvcmRzLlxuICAgICAgICAgIGlmIChzaGlwTmFtZSA9PT0gXCJjYXJyaWVyXCIpIHBsYXllclNoaXBzLmNhcnJpZXIuaGl0KCk7XG4gICAgICAgICAgaWYgKHNoaXBOYW1lID09PSBcImJhdHRsZVNoaXBcIikgcGxheWVyU2hpcHMuYmF0dGxlU2hpcC5oaXQoKTtcbiAgICAgICAgICBpZiAoc2hpcE5hbWUgPT09IFwiYmF0dGxlU2hpcDFcIikgcGxheWVyU2hpcHMuYmF0dGxlU2hpcDEuaGl0KCk7XG4gICAgICAgICAgaWYgKHNoaXBOYW1lID09PSBcImNydWlzZXJcIikgcGxheWVyU2hpcHMuY3J1aXNlci5oaXQoKTtcbiAgICAgICAgICBpZiAoc2hpcE5hbWUgPT09IFwiY3J1aXNlcjFcIikgcGxheWVyU2hpcHMuY3J1aXNlcjEuaGl0KCk7XG4gICAgICAgICAgaWYgKHNoaXBOYW1lID09PSBcImNydWlzZXIyXCIpIHBsYXllclNoaXBzLmNydWlzZXIyLmhpdCgpO1xuICAgICAgICAgIGlmIChzaGlwTmFtZSA9PT0gXCJkZXN0cm95ZXJcIikgcGxheWVyU2hpcHMuZGVzdHJveWVyLmhpdCgpO1xuICAgICAgICAgIGlmIChzaGlwTmFtZSA9PT0gXCJkZXN0cm95ZXIxXCIpIHBsYXllclNoaXBzLmRlc3Ryb3llcjEuaGl0KCk7XG4gICAgICAgICAgaWYgKHNoaXBOYW1lID09PSBcImRlc3Ryb3llcjJcIikgcGxheWVyU2hpcHMuZGVzdHJveWVyMi5oaXQoKTtcbiAgICAgICAgICBpZiAoc2hpcE5hbWUgPT09IFwiZGVzdHJveWVyM1wiKSBwbGF5ZXJTaGlwcy5kZXN0cm95ZXIzLmhpdCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHN1Y2Nlc3MgPT09IHRydWUpIGJyZWFrO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCBjaGVja1N1bmsgPSAocGxheWVyU2hpcHMpID0+IHtcbiAgICAgIGNvbnN0IGFyZUFsbFN1bmsgPSAoc2hpcHMpID0+IHtcbiAgICAgICAgLy8gZWl0aGVyIHdlIGRpZG4ndCBkZWZpbmVkIHRoZSBjb3JkcyBvZiBhIHNoaXAgKHVuZGVmaW5lZCksIG9yIGl0IGlzIGFjdHVhbGx5IHN1bmssIHdlIHRha2UgdGhhdCBhcyB0cnVlLlxuICAgICAgICBpZiAoXG4gICAgICAgICAgKCFzaGlwcy5jYXJyaWVyLmN1cnJlbnRDb3JkcyB8fFxuICAgICAgICAgICAgc2hpcHMuY2Fycmllci5pc1N1bmsoKSkgJiZcbiAgICAgICAgICAoIXNoaXBzLmJhdHRsZVNoaXAuY3VycmVudENvcmRzIHx8XG4gICAgICAgICAgICBzaGlwcy5iYXR0bGVTaGlwLmlzU3VuaygpKSAmJlxuICAgICAgICAgICghc2hpcHMuYmF0dGxlU2hpcDEuY3VycmVudENvcmRzIHx8XG4gICAgICAgICAgICBzaGlwcy5iYXR0bGVTaGlwMS5pc1N1bmsoKSkgJiZcbiAgICAgICAgICAoIXNoaXBzLmNydWlzZXIuY3VycmVudENvcmRzIHx8XG4gICAgICAgICAgICBzaGlwcy5jcnVpc2VyLmlzU3VuaygpKSAmJlxuICAgICAgICAgICghc2hpcHMuY3J1aXNlcjEuY3VycmVudENvcmRzIHx8XG4gICAgICAgICAgICBzaGlwcy5jcnVpc2VyMS5pc1N1bmsoKSkgJiZcbiAgICAgICAgICAoIXNoaXBzLmNydWlzZXIyLmN1cnJlbnRDb3JkcyB8fFxuICAgICAgICAgICAgc2hpcHMuY3J1aXNlcjIuaXNTdW5rKCkpICYmXG4gICAgICAgICAgKCFzaGlwcy5kZXN0cm95ZXIuY3VycmVudENvcmRzIHx8XG4gICAgICAgICAgICBzaGlwcy5kZXN0cm95ZXIuaXNTdW5rKCkpICYmXG4gICAgICAgICAgKCFzaGlwcy5kZXN0cm95ZXIxLmN1cnJlbnRDb3JkcyB8fFxuICAgICAgICAgICAgc2hpcHMuZGVzdHJveWVyMS5pc1N1bmsoKSkgJiZcbiAgICAgICAgICAoIXNoaXBzLmRlc3Ryb3llcjIuY3VycmVudENvcmRzIHx8XG4gICAgICAgICAgICBzaGlwcy5kZXN0cm95ZXIyLmlzU3VuaygpKSAmJlxuICAgICAgICAgICghc2hpcHMuZGVzdHJveWVyMy5jdXJyZW50Q29yZHMgfHxcbiAgICAgICAgICAgIHNoaXBzLmRlc3Ryb3llcjMuaXNTdW5rKCkpXG4gICAgICAgIClcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4gYXJlQWxsU3VuayhwbGF5ZXJTaGlwcyk7XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICByZWNlaXZlQXR0YWNrLFxuICAgICAgZGVwbG95U2hpcHMsXG4gICAgICByZWNlaXZlZEF0dGFja3MsXG4gICAgICBzdWNjZXNzQXR0YWNrcyxcbiAgICAgIGNoZWNrU3VuayxcbiAgICB9O1xuICB9O1xuXG4gIHJldHVybiB7IFNoaXAsIEdhbWVib2FyZCB9O1xufSkoKTtcblxuY29uc3QgcGxheWVyTG9naWMgPSAoKCkgPT4ge1xuICBjb25zdCBQbGF5ZXIgPSAobmFtZSwgc2hpcHNDb3JkcykgPT4ge1xuICAgIGNvbnN0IHBsYXllck5hbWUgPSBuYW1lO1xuXG4gICAgY29uc3QgcGxheWVyQm9hcmQgPSBtYWluT2JqZWN0cy5HYW1lYm9hcmQoKTtcblxuICAgIGNvbnN0IHBsYXllclNoaXBzID0gcGxheWVyQm9hcmQuZGVwbG95U2hpcHMoLi4uc2hpcHNDb3Jkcyk7XG5cbiAgICBjb25zdCByZWNlaXZlQXR0YWNrID0gKGNvb3JkaW5hdGVzKSA9PlxuICAgICAgcGxheWVyQm9hcmQucmVjZWl2ZUF0dGFjayhjb29yZGluYXRlcywgcGxheWVyU2hpcHMpO1xuXG4gICAgcmV0dXJuIHsgcGxheWVyTmFtZSwgcGxheWVyQm9hcmQsIHBsYXllclNoaXBzLCByZWNlaXZlQXR0YWNrIH07XG4gIH07XG5cbiAgY29uc3QgY3B1UGxheWVyID0gKGh1bWFuUGxheWVyLCBzaGlwc0NvcmRzKSA9PiB7XG4gICAgY29uc3Qgcml2YWxQbGF5ZXIgPSBodW1hblBsYXllcjtcblxuICAgIGNvbnN0IGNwdUJvYXJkID0gbWFpbk9iamVjdHMuR2FtZWJvYXJkKCk7XG5cbiAgICBjb25zdCBjcHVTaGlwcyA9IGNwdUJvYXJkLmRlcGxveVNoaXBzKC4uLnNoaXBzQ29yZHMpO1xuXG4gICAgY29uc3QgcmVjZWl2ZUF0dGFjayA9IChjb29yZGluYXRlcykgPT5cbiAgICAgIGNwdUJvYXJkLnJlY2VpdmVBdHRhY2soY29vcmRpbmF0ZXMsIGNwdVNoaXBzKTtcblxuICAgIGNvbnN0IHVzZWRDb29yZHMgPSBbXTtcblxuICAgIGNvbnN0IGF0dGFja1BsYXllciA9IChjb29yZHMpID0+IHtcblxuICAgICAgY29uc3QgcmFuZG9tSW50ID0gKG1heCkgPT4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbWF4KTtcblxuICAgICAgY29uc3QgcmFuZG9tQ29vcmRzID0gW3JhbmRvbUludCg5KSwgcmFuZG9tSW50KDkpXTtcblxuICAgICAgLy8gY2FsbCB0aGUgZnVuY3Rpb24gYWdhaW4gYW5kIGdlbmVyYXRlIG5ldyByYW5kb20gY29vcmRzIGlmIHRoZSBhdHRhY2sgaGFzIGFscmVhZHkgYmUgZG9uZSBpbiB0aGF0IGNvb3JkaW5hdGUuXG4gICAgICBpZiAoaXNUYXJnZXRJbkFycmF5KHVzZWRDb29yZHMsIGNvb3JkcykpIHJldHVybiBhdHRhY2tQbGF5ZXIoKTtcblxuICAgICAgaWYgKGlzVGFyZ2V0SW5BcnJheSh1c2VkQ29vcmRzLCByYW5kb21Db29yZHMpKSByZXR1cm4gYXR0YWNrUGxheWVyKCk7XG5cbiAgICAgIGlmICghY29vcmRzKSB7XG4gICAgICAgIC8vIGlmIHdlIHNldCBtYW51YWwgZW1wdHkgY29vcmRzIGZvciB0ZXN0aW5nIG9yIGFub3RoZXIgcHVycG9zZXMuXG4gICAgICAgIHVzZWRDb29yZHMucHVzaChjb29yZHMpO1xuICAgICAgICByZXR1cm4gcml2YWxQbGF5ZXIucmVjZWl2ZUF0dGFjayhjb29yZHMpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcml2YWxQbGF5ZXIucmVjZWl2ZUF0dGFjayhyYW5kb21Db29yZHMpO1xuICAgIH07XG5cbiAgICByZXR1cm4geyBhdHRhY2tQbGF5ZXIsIGNwdUJvYXJkLCBjcHVTaGlwcywgcmVjZWl2ZUF0dGFjayB9O1xuICB9O1xuXG4gIHJldHVybiB7IFBsYXllciwgY3B1UGxheWVyIH07XG59KSgpO1xuXG5jb25zdCBHYW1lID0gKCgpID0+IHtcbiAgY29uc3QgbmV3R2FtZSA9IChwbGF5ZXJOYW1lLCBwbGF5ZXJDb29yZHMsIGNwdUNvb3JkcykgPT4ge1xuICAgIGNvbnN0IFBsYXllciA9IHBsYXllckxvZ2ljLlBsYXllcihwbGF5ZXJOYW1lLCBwbGF5ZXJDb29yZHMpO1xuXG4gICAgY29uc3QgY3B1UGxheWVyID0gcGxheWVyTG9naWMuY3B1UGxheWVyKFBsYXllciwgY3B1Q29vcmRzKTtcblxuICAgIHJldHVybiB7IFBsYXllciwgY3B1UGxheWVyIH07XG4gIH07XG5cbiAgcmV0dXJuIHsgbmV3R2FtZSB9O1xufSkoKTtcblxuY29uc3QgRE9NTG9naWMgPSAoKCkgPT4ge1xuICBjb25zdCBkaXNwbGF5R3JpZCA9IChncmlkMSwgZ3JpZDIpID0+IHtcbiAgICBjb25zdCBjcmVhdGVHcmlkID0gKHNpemUpID0+IHtcbiAgICAgIGNvbnN0IHJlY3Vyc2l2ZSA9ICh5UG9zKSA9PiB7XG4gICAgICAgIGlmICh5UG9zID09PSBzaXplKSByZXR1cm47XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgICAgICBjb25zdCBncmlkRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgZ3JpZEVsZW1lbnQuY2xhc3NOYW1lID0gYCR7eVBvc30sJHtpfWA7XG5cbiAgICAgICAgICBjb25zdCBncmlkRWxlbWVudDIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgIGdyaWRFbGVtZW50Mi5jbGFzc05hbWUgPSBgJHt5UG9zfSwke2l9YDtcblxuICAgICAgICAgIGlmIChncmlkMSlcbiAgICAgICAgICAgIGdyaWQxLmFwcGVuZENoaWxkKGdyaWRFbGVtZW50KTtcbiAgICAgICAgICBpZiAoZ3JpZDIpXG4gICAgICAgICAgICBncmlkMi5hcHBlbmRDaGlsZChncmlkRWxlbWVudDIpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVjdXJzaXZlKHlQb3MgKyAxKTtcbiAgICAgIH07XG4gICAgICByZWN1cnNpdmUoMCk7XG4gICAgfTtcblxuICAgIGNyZWF0ZUdyaWQoMTApO1xuICB9O1xuXG4gIGNvbnN0IFVJTG9naWMgPSAobm9kZXMxLCBub2RlczIsIGdhbWVJbmZvKSA9PiB7XG4gICAgY29uc3QgcGxheWVyMUNvb3JkcyA9IGdhbWVJbmZvLlBsYXllci5wbGF5ZXJTaGlwcy5jb29yZGluYXRlcztcblxuICAgIGNvbnN0IHBsYXllcjJDb29yZHMgPSBnYW1lSW5mby5jcHVQbGF5ZXIuY3B1U2hpcHMuY29vcmRpbmF0ZXM7XG5cbiAgICBjb25zdCBhdHRhY2tQbGF5ZXIgPSAoY29vcmQpID0+IGdhbWVJbmZvLlBsYXllci5yZWNlaXZlQXR0YWNrKGNvb3JkKTtcblxuICAgIGNvbnN0IGF0dGFja0NwdSA9IChjb29yZCkgPT4gZ2FtZUluZm8uY3B1UGxheWVyLnJlY2VpdmVBdHRhY2soY29vcmQpO1xuXG4gICAgY29uc3QgYXR0YWNrT25DbGljayA9IChzaGlwQ29vcmRzLCBub2RlQ29vcmQsIGF0dGFja0Z1bmN0aW9uKSA9PiB7XG4gICAgICAvLyBpZiB0aGUgcGxheWVyIGhhcyBhIHNoaXAgaW4gdGhlIGNsaWNrZWQgY29vcmRpbmF0ZSwgYXR0YWNrIHRoZSBwbGF5ZXIgdG8gdGhhdCBzcGVjaWZpYyBjb29yZC5cbiAgICAgIGxldCB3YXNTdWNjZXNzZnVsID0gZmFsc2U7XG4gICAgICBpZiAoaXNUYXJnZXRJbkFycmF5KE9iamVjdC52YWx1ZXMoc2hpcENvb3JkcyksIG5vZGVDb29yZCkpIHtcbiAgICAgICAgLy8gd2hlbiB0aGUgbm9kZUNvb3JkIGlzIGluc2lkZSBvZiBhIG9uZS1jb29yZGluYXRlIHNoaXAsIHRoaXMgY29uZGl0aW9uYWwgaXMgdXNlZC5cbiAgICAgICAgYXR0YWNrRnVuY3Rpb24obm9kZUNvb3JkKTtcbiAgICAgICAgd2FzU3VjY2Vzc2Z1bCA9IHRydWU7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9XG4gICAgICAvLyB3aGVuIHRoZSBub2RlQ29vcmQgaXMgaW5zaWRlIG9mIGEgbXVsdGlwbGUtY29vcmRpbmF0ZSBzaGlwLlxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwQ29vcmRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIC8vIGxvb3AgdGhyb3VnaCB0aGUgY29vcmRzIGFycmF5IG9mIGVhY2ggc2hpcCwgdW50aWwgdGhlIG5vZGVDb29yZCBpcyBmb3VuZC5cbiAgICAgICAgY29uc3QgY3VycmVudENvb3JkcyA9IHNoaXBDb29yZHNbaV07XG4gICAgICAgIGlmIChpc1RhcmdldEluQXJyYXkoY3VycmVudENvb3Jkcywgbm9kZUNvb3JkKSkge1xuICAgICAgICAgIGF0dGFja0Z1bmN0aW9uKG5vZGVDb29yZCk7XG4gICAgICAgICAgd2FzU3VjY2Vzc2Z1bCA9IHRydWU7XG4gICAgICAgICAgYnJlYWs7IC8vIHN0b3AgbG9vcGluZyB0aHJvdWdoIHRoZSBzaGlwcyBjb29yZHMgdG8gb3B0aW1pemUgdGltZSBjb21wbGV4aXR5LlxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gd2FzU3VjY2Vzc2Z1bDtcbiAgICB9O1xuXG4gICAgLy8gbm90ZSwgdGhlIGF0dGFja09uQ2xpY2sgZnVuY3Rpb24gd2lsbCBhbHdheXMgY2FsbCB0aGUgYXR0YWNrRnVuY3Rpb24gb24gYSBzdWNjZXNzZnVsIGF0dGFjay5cbiAgICAvLyB0aGF0J3Mgd2h5IHdlIHdpbGwgbmVlZCB0aGUgbmV4dCBmdW5jdGlvbi5cblxuICAgIGNvbnN0IG1pc3NlZEF0dGFja09uQ2xpY2sgPSAobm9kZUNvb3JkLCBhdHRhY2tGdW5jdGlvbikgPT4ge1xuICAgICAgYXR0YWNrRnVuY3Rpb24obm9kZUNvb3JkKVxuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgY29uc3QgY2xhc3NUb0FycmF5ID0gKGNsYXNzQ29vcmQpID0+IHtcbiAgICAgIGNvbnN0IGFycmF5Q29vcmQgPSBbXTtcblxuICAgICAgY29uc3QgeCA9IGNsYXNzQ29vcmQuc2xpY2UoMCwgMSk7XG5cbiAgICAgIGNvbnN0IHkgPSBjbGFzc0Nvb3JkLnNsaWNlKDIsIDMpO1xuXG4gICAgICBhcnJheUNvb3JkLnB1c2goTnVtYmVyKHgpKTtcbiAgICAgIGFycmF5Q29vcmQucHVzaChOdW1iZXIoeSkpO1xuXG4gICAgICByZXR1cm4gYXJyYXlDb29yZDtcbiAgICB9O1xuXG4gICAgY29uc3QgdmlzdWFsSW5kaWNhdG9ycyA9IChlLCB3YXNTdWNjZXNzZnVsKSA9PiB7XG4gICAgICBjb25zdCBjdXJyZW50Tm9kZSA9IGUudGFyZ2V0O1xuICAgICAgaWYgKHdhc1N1Y2Nlc3NmdWwgPT09IGZhbHNlKSBjdXJyZW50Tm9kZS50ZXh0Q29udGVudCA9IFwi4oCiXCI7XG4gICAgICBlbHNlIHtcbiAgICAgICAgY3VycmVudE5vZGUudGV4dENvbnRlbnQgPSBcIlhcIjtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgZGV0ZWN0QXR0YWNrcyA9IChlKSA9PiB7XG4gICAgICBjb25zdCBwYXJlbnRDbGFzcyA9IGUudGFyZ2V0LnBhcmVudEVsZW1lbnQuY2xhc3NOYW1lO1xuXG4gICAgICBjb25zdCBub2RlQ2xhc3MgPSBlLnRhcmdldC5jbGFzc05hbWU7XG5cbiAgICAgIGNvbnN0IG5vZGVDb29yZCA9IGNsYXNzVG9BcnJheShub2RlQ2xhc3MpO1xuXG4gICAgICBpZiAocGFyZW50Q2xhc3MgPT09IFwiZ3JpZC0xXCIpIHtcbiAgICAgICAgLy8gaWYgdGhlIGNsaWNrZWQgY29vcmRpbmF0ZSBpcyBpbnNpZGUgb2YgZ3JpZC0xLCB3ZSBrbm93IHRoYXQgaXQgaXMgYW4gYXR0YWNrIHRvIHBsYXllcjEuXG5cbiAgICAgICAgY29uc3QgY2xlYW5Db29yZHMgPSBPYmplY3QudmFsdWVzKHBsYXllcjFDb29yZHMpLmZpbHRlcihcbiAgICAgICAgICAoY29vcmRzKSA9PiBjb29yZHMgIT09IHVuZGVmaW5lZFxuICAgICAgICApOyAvLyBmaWx0ZXIgdW5kZWZpbmVkIGNvb3Jkcy5cbiAgICAgICAgaWYgKGF0dGFja09uQ2xpY2soY2xlYW5Db29yZHMsIG5vZGVDb29yZCwgYXR0YWNrUGxheWVyKSA9PT0gdHJ1ZSkgcmV0dXJuIHRydWVcbiAgICAgICAgcmV0dXJuIG1pc3NlZEF0dGFja09uQ2xpY2sobm9kZUNvb3JkLCBhdHRhY2tQbGF5ZXIpXG4gICAgICB9XG5cbiAgICAgIGlmIChwYXJlbnRDbGFzcyA9PT0gXCJncmlkLTJcIikge1xuICAgICAgICBjb25zdCBjbGVhbkNvb3JkcyA9IE9iamVjdC52YWx1ZXMocGxheWVyMkNvb3JkcykuZmlsdGVyKFxuICAgICAgICAgIChjb29yZHMpID0+IGNvb3JkcyAhPT0gdW5kZWZpbmVkXG4gICAgICAgICk7XG4gICAgICAgIGlmIChhdHRhY2tPbkNsaWNrKGNsZWFuQ29vcmRzLCBub2RlQ29vcmQsIGF0dGFja0NwdSkgPT09IHRydWUpIHJldHVybiB0cnVlXG4gICAgICAgIHJldHVybiBtaXNzZWRBdHRhY2tPbkNsaWNrKG5vZGVDb29yZCwgYXR0YWNrQ3B1KVxuICAgICAgfVxuICAgIH07XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG5vZGVzMS5sZW5ndGg7IGkrKykge1xuICAgICAgbm9kZXMxW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgICBpZiAoZGV0ZWN0QXR0YWNrcyhlKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICB2aXN1YWxJbmRpY2F0b3JzKGUsIGZhbHNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2aXN1YWxJbmRpY2F0b3JzKGUsIHRydWUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIG5vZGVzMltpXS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgaWYgKGRldGVjdEF0dGFja3MoZSkgPT09IGZhbHNlKSB7XG4gICAgICAgICAgdmlzdWFsSW5kaWNhdG9ycyhlLCBmYWxzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmlzdWFsSW5kaWNhdG9ycyhlLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHN0YXJ0R2FtZSA9IChcbiAgICBncmlkQ29udGFpbmVyMSxcbiAgICBncmlkQ29udGFpbmVyMixcbiAgICBwbGF5ZXJDb29yZHMsXG4gICAgY3B1Q29vcmRzXG4gICkgPT4ge1xuICAgIGNvbnN0IGN1cnJlbnRHYW1lID0gR2FtZS5uZXdHYW1lKFwiZXhhbXBsZVwiLCBwbGF5ZXJDb29yZHMsIGNwdUNvb3Jkcyk7XG5cbiAgICBpZiAoXG4gICAgICBncmlkQ29udGFpbmVyMSAmJlxuICAgICAgZ3JpZENvbnRhaW5lcjJcbiAgICApIHtcbiAgICAgIFVJTG9naWMoXG4gICAgICAgIGdyaWRDb250YWluZXIxLmNoaWxkTm9kZXMsXG4gICAgICAgIGdyaWRDb250YWluZXIyLmNoaWxkTm9kZXMsXG4gICAgICAgIGN1cnJlbnRHYW1lXG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiB7IGN1cnJlbnRHYW1lLCBncmlkQ29udGFpbmVyMSwgZ3JpZENvbnRhaW5lcjIgfTtcbiAgfTtcblxuICBjb25zdCBnZW5ET01FbGVtZW50cyA9ICgpID0+IHtcbiAgICBjb25zdCBjb29yZFRvQ2xhc3MgPSAoYXJyKSA9PiBgJHthcnIuc2xpY2UoMCwgMSl9LCR7YXJyLnNsaWNlKDEsIDIpfWA7XG5cbiAgICBjb25zdCBjaGFuZ2VDb29yZENvbG9yID0gKGNsYXNzTmFtZSwgZ3JpZE51bWJlcikgPT4ge1xuICAgICAgY29uc3QgY3VycmVudENvb3JkID1cbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShjbGFzc05hbWUpW2dyaWROdW1iZXIgLSAxXTtcblxuICAgICAgaWYgKGN1cnJlbnRDb29yZClcbiAgICAgICAgY3VycmVudENvb3JkLnN0eWxlLmJvcmRlciA9IFwiMXB4IHNvbGlkIGdyZWVuXCI7XG4gICAgfTtcblxuICAgIGNvbnN0IGZsYXRDb29yZHMgPSAoY29vcmRzQXJyKSA9PiB7XG4gICAgICBjb25zdCBvbmVEaW1lbnNpb25Db29yZHMgPSBbXTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb29yZHNBcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgY29vcmRzID0gY29vcmRzQXJyW2ldO1xuXG4gICAgICAgIGlmICh0eXBlb2YgY29vcmRzWzBdID09PSBcIm9iamVjdFwiKVxuICAgICAgICAgIG9uZURpbWVuc2lvbkNvb3Jkcy5wdXNoKFxuICAgICAgICAgICAgLi4uY29vcmRzXG4gICAgICAgICAgKTsgLy8gaWYgdGhlIHNoaXBzIGhhdmUgbW9yZSB0aGFuIG9uZSBjb29yZGluYXRlLlxuICAgICAgICBlbHNlIG9uZURpbWVuc2lvbkNvb3Jkcy5wdXNoKGNvb3Jkcyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gb25lRGltZW5zaW9uQ29vcmRzO1xuICAgIH07XG5cbiAgICBjb25zdCBzaG93U2hpcHMgPSAoY3VycmVudENvb3JkcywgZ3JpZE51bWJlcikgPT4ge1xuICAgICAgY29uc3QgY29vcmRzID0gZmxhdENvb3JkcyhjdXJyZW50Q29vcmRzKTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY2hhbmdlQ29vcmRDb2xvcihjb29yZFRvQ2xhc3MoY29vcmRzW2ldKSwgZ3JpZE51bWJlcik7XG4gICAgICB9XG4gICAgfTtcblxuICAgIGNvbnN0IGRlbGV0ZUVsZW1lbnRzID0gKCkgPT4ge1xuICAgICAgY29uc3QgZ3JpZHNDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwiZ3JpZHMtY29udGFpbmVyXCIpWzBdXG4gICAgICBpZiAoZ3JpZHNDb250YWluZXIpIGdyaWRzQ29udGFpbmVyLnJlbW92ZSgpXG4gICAgfVxuXG4gICAgY29uc3QgZ2VuR3JpZCA9IChwbGF5ZXJJbmRleCwgY29vcmRzKSA9PiB7XG5cbiAgICAgIGNvbnN0IGdyaWRzQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlY3Rpb25cIilcbiAgICAgIGdyaWRzQ29udGFpbmVyLmNsYXNzTmFtZSA9IFwiZ3JpZHMtY29udGFpbmVyXCJcblxuICAgICAgY29uc3QgbWFpbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJtYWluXCIpXG4gICAgICBpZiAobWFpbilcbiAgICAgICAgbWFpbi5hcHBlbmRDaGlsZChncmlkc0NvbnRhaW5lcilcblxuICAgICAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoM1wiKVxuICAgICAgbmFtZS50ZXh0Q29udGVudCA9IGBQbGF5ZXIncyAke3BsYXllckluZGV4fSBHcmlkYFxuICAgICAgZ3JpZHNDb250YWluZXIuYXBwZW5kQ2hpbGQobmFtZSlcblxuICAgICAgY29uc3QgZ3JpZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICBncmlkLmNsYXNzTmFtZSA9IGBncmlkLSR7cGxheWVySW5kZXh9YDtcbiAgICAgIGdyaWRzQ29udGFpbmVyLmFwcGVuZENoaWxkKGdyaWQpO1xuXG4gICAgICBpZiAocGxheWVySW5kZXggPT09IDEpXG4gICAgICAgIERPTUxvZ2ljLmRpc3BsYXlHcmlkKGdyaWQsIG51bGwpXG5cbiAgICAgIGVsc2Uge1xuICAgICAgICBET01Mb2dpYy5kaXNwbGF5R3JpZChudWxsLCBncmlkKVxuICAgICAgfVxuXG4gICAgICBpZiAoY29vcmRzKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKVxuICAgICAgICBzdGFydEJ1dHRvbi5jbGFzc05hbWUgPSBcInN0YXJ0LWJ1dHRvblwiXG4gICAgICAgIGdyaWRzQ29udGFpbmVyLmFwcGVuZENoaWxkKHN0YXJ0QnV0dG9uKVxuICAgICAgICBzdGFydEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU3RhcnQgR2FtZVwiXG5cbiAgICAgICAgc2hvd1NoaXBzKGNvb3JkcywgcGxheWVySW5kZXgpXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBncmlkO1xuICAgIH07XG5cblxuICAgIHJldHVybiB7IGdlbkdyaWQsIGRlbGV0ZUVsZW1lbnRzIH1cbiAgfTtcblxuICByZXR1cm4geyBzdGFydEdhbWUsIGRpc3BsYXlHcmlkLCBnZW5ET01FbGVtZW50cyB9O1xufSkoKTtcblxuY29uc3QgR2FtZUxvb3AgPSAoKCkgPT4ge1xuXG4gIGNvbnN0IGdhbWVUdXJucyA9IChwbGF5ZXIyLCBwbGF5ZXIxQ29vcmRzKSA9PiB7XG5cbiAgICBsZXQgcGxheWVyMkF0dGFja3NDb3VudCA9IDBcblxuICAgIGNvbnN0IHR1cm5zTG9naWMgPSAoKSA9PiB7XG5cbiAgICAgIGlmIChwbGF5ZXIyLmNwdUJvYXJkLnJlY2VpdmVkQXR0YWNrcy5sZW5ndGggPT09IHBsYXllcjJBdHRhY2tzQ291bnQgKyAxKSB7XG4gICAgICAgIHBsYXllcjJBdHRhY2tzQ291bnQrK1xuICAgICAgICBwbGF5ZXIyLmF0dGFja1BsYXllcihwbGF5ZXIxQ29vcmRzKVxuICAgICAgfVxuXG4gICAgfVxuICAgIHJldHVybiB7IHR1cm5zTG9naWMgfVxuICB9XG5cbiAgY29uc3QgRXhhbXBsZUNvb3JkcyA9IFtcbiAgICBbWzAsIDFdLCBbMCwgMl0sIFswLCAzXSwgWzAsIDRdLF0sXG4gICAgW1syLCAxXSwgWzMsIDFdLCBbNCwgMV0sXSxcbiAgICBbWzAsIDZdLCBbMCwgN10sIFswLCA4XSxdLFxuICAgIFtbMywgM10sIFszLCA0XSxdLFxuICAgIFtbNiwgM10sIFs2LCAyXSxdLFxuICAgIFtbNiwgOF0sIFs2LCA5XSxdLFxuICAgIFs3LCA1XSxcbiAgICBbOSwgMl0sXG4gICAgWzksIDldLFxuICAgIFs4LCA3XSxcbiAgXTtcblxuICBjb25zdCBnZW5ET00gPSBET01Mb2dpYy5nZW5ET01FbGVtZW50cygpXG5cbiAgY29uc3Qgc2luZ2xlUGxheWVyID0gKCkgPT4ge1xuXG4gICAgY29uc3QgbmV3R2FtZSA9IERPTUxvZ2ljLnN0YXJ0R2FtZShcbiAgICAgIGdlbkRPTS5nZW5HcmlkKDEpLFxuICAgICAgZ2VuRE9NLmdlbkdyaWQoMiksXG4gICAgICBFeGFtcGxlQ29vcmRzLFxuICAgICAgRXhhbXBsZUNvb3Jkc1xuICAgICk7XG5cbiAgICBnZW5ET00uZGVsZXRlRWxlbWVudHMoKVxuXG4gICAgY29uc3QgcGxheWVyT2JqID0gbmV3R2FtZS5jdXJyZW50R2FtZS5QbGF5ZXJcbiAgICBjb25zdCBjcHVPYmogPSBuZXdHYW1lLmN1cnJlbnRHYW1lLmNwdVBsYXllclxuICAgIGNvbnN0IGN1cnJlbnRUdXJuID0gZ2FtZVR1cm5zKGNwdU9iaiwgRXhhbXBsZUNvb3JkcylcbiAgICBjb25zdCBjcHVHcmlkID0gbmV3R2FtZS5ncmlkQ29udGFpbmVyMlxuXG4gICAgLy8gcmVjZWl2ZSBjb29yZHMsIGdyaWQgY29udGFpbmVycyBhbmQgc3RhcnQgdGhlIGdhbWUuXG5cbiAgICBjb25zdCB0dXJuTG9vcCA9IChwbGF5ZXIsIHBsYXllcjIsIGdhbWVUdXJuLCBwbGF5ZXIyR3JpZCkgPT4ge1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBsYXllcjJHcmlkLmNoaWxkTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IHBsYXllcjJHcmlkLmNoaWxkTm9kZXNbaV07XG4gICAgICAgIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGdhbWVUdXJuLnR1cm5zTG9naWMpXG4gICAgICB9XG4gICAgfVxuXG4gICAgdHVybkxvb3AocGxheWVyT2JqLCBjcHVPYmosIGN1cnJlbnRUdXJuLCBjcHVHcmlkKVxuXG4gICAgcmV0dXJuIHsgcGxheWVyT2JqLCBjcHVPYmogfVxuXG4gIH1cblxuICBjb25zdCBzZXR1cERPTSA9ICgpID0+IHtcblxuICAgIGdlbkRPTS5nZW5HcmlkKDEsIEV4YW1wbGVDb29yZHMpXG5cbiAgICBjb25zdCBzdGFydEJ1dHRvbiA9XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwic3RhcnQtYnV0dG9uXCIpWzBdO1xuXG4gICAgaWYgKHN0YXJ0QnV0dG9uKVxuICAgICAgc3RhcnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHNpbmdsZVBsYXllcilcblxuICB9XG5cbiAgcmV0dXJuIHsgc2luZ2xlUGxheWVyLCBzZXR1cERPTSB9O1xuXG59KSgpO1xuXG5HYW1lTG9vcC5zZXR1cERPTSgpXG5cblxuZXhwb3J0IHsgbWFpbk9iamVjdHMsIHBsYXllckxvZ2ljLCBHYW1lLCBET01Mb2dpYywgR2FtZUxvb3AsIGlzVGFyZ2V0SW5BcnJheSB9O1xuIl0sIm5hbWVzIjpbImlzVGFyZ2V0SW5BcnJheSIsImFyciIsInRhcmdldCIsImNvbnRhaW5zIiwiSlNPTiIsInN0cmluZ2lmeSIsInVuZGVmaW5lZCIsImkiLCJsZW5ndGgiLCJlbGVtZW50IiwibWFpbk9iamVjdHMiLCJTaGlwIiwibGVuZ3RoTnVtYmVyIiwiaGl0c051bWJlciIsImNvb3JkcyIsInNoaXBIaXRzIiwic2hpcExlbmd0aCIsImlzU3VuayIsImhpdCIsImN1cnJlbnRIaXRzIiwiY3VycmVudENvcmRzIiwiR2FtZWJvYXJkIiwicmVjZWl2ZWRBdHRhY2tzIiwic3VjY2Vzc0F0dGFja3MiLCJyZWNlaXZlQXR0YWNrIiwidGFyZ2V0Q29yZHMiLCJwbGF5ZXJTaGlwcyIsImN1cnJlbnRTaGlwcyIsIk9iamVjdCIsImVudHJpZXMiLCJjb29yZGluYXRlcyIsInB1c2giLCJzdWNjZXNzIiwic2hpcENvcmRzIiwic2hpcE5hbWUiLCJjYXJyaWVyIiwiYmF0dGxlU2hpcCIsImJhdHRsZVNoaXAxIiwiY3J1aXNlciIsImNydWlzZXIxIiwiY3J1aXNlcjIiLCJkZXN0cm95ZXIiLCJkZXN0cm95ZXIxIiwiZGVzdHJveWVyMiIsImRlc3Ryb3llcjMiLCJkZXBsb3lTaGlwcyIsImNhcnJpZXJDb3JkcyIsImJhdHRsZVNoaXBDb3JkcyIsImJhdHRsZVNoaXAxQ29yZHMiLCJjcnVpc2VyQ29yZHMiLCJjcnVpc2VyMUNvcmRzIiwiY3J1aXNlcjJDb3JkcyIsImRlc3Ryb3llckNvcmRzIiwiZGVzdHJveWVyMUNvcmRzIiwiZGVzdHJveWVyMkNvcmRzIiwiZGVzdHJveWVyM0NvcmRzIiwiY2hlY2tTdW5rIiwic2hpcHMiLCJwbGF5ZXJMb2dpYyIsIm5hbWUiLCJzaGlwc0NvcmRzIiwicGxheWVyTmFtZSIsInBsYXllckJvYXJkIiwiaHVtYW5QbGF5ZXIiLCJyaXZhbFBsYXllciIsImNwdUJvYXJkIiwiY3B1U2hpcHMiLCJ1c2VkQ29vcmRzIiwiYXR0YWNrUGxheWVyIiwicmFuZG9tSW50IiwibWF4IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicmFuZG9tQ29vcmRzIiwiR2FtZSIsInBsYXllckNvb3JkcyIsImNwdUNvb3JkcyIsIlBsYXllciIsImNwdVBsYXllciIsIkRPTUxvZ2ljIiwic3RhcnRHYW1lIiwiZ3JpZENvbnRhaW5lcjEiLCJncmlkQ29udGFpbmVyMiIsImN1cnJlbnRHYW1lIiwibm9kZXMxIiwibm9kZXMyIiwiZ2FtZUluZm8iLCJwbGF5ZXIxQ29vcmRzIiwicGxheWVyMkNvb3JkcyIsImNvb3JkIiwiYXR0YWNrQ3B1IiwiYXR0YWNrT25DbGljayIsInNoaXBDb29yZHMiLCJub2RlQ29vcmQiLCJhdHRhY2tGdW5jdGlvbiIsIndhc1N1Y2Nlc3NmdWwiLCJ2YWx1ZXMiLCJjdXJyZW50Q29vcmRzIiwibWlzc2VkQXR0YWNrT25DbGljayIsInZpc3VhbEluZGljYXRvcnMiLCJlIiwidGV4dENvbnRlbnQiLCJkZXRlY3RBdHRhY2tzIiwicGFyZW50Q2xhc3MiLCJwYXJlbnRFbGVtZW50IiwiY2xhc3NOYW1lIiwiY2xhc3NDb29yZCIsImFycmF5Q29vcmQiLCJ4Iiwic2xpY2UiLCJ5IiwiTnVtYmVyIiwiY2xhc3NUb0FycmF5IiwiY2xlYW5Db29yZHMiLCJmaWx0ZXIiLCJhZGRFdmVudExpc3RlbmVyIiwiVUlMb2dpYyIsImNoaWxkTm9kZXMiLCJkaXNwbGF5R3JpZCIsImdyaWQxIiwiZ3JpZDIiLCJzaXplIiwicmVjdXJzaXZlIiwieVBvcyIsImdyaWRFbGVtZW50IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiZ3JpZEVsZW1lbnQyIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVHcmlkIiwiZ2VuRE9NRWxlbWVudHMiLCJjaGFuZ2VDb29yZENvbG9yIiwiZ3JpZE51bWJlciIsImN1cnJlbnRDb29yZCIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJzdHlsZSIsImJvcmRlciIsImdlbkdyaWQiLCJwbGF5ZXJJbmRleCIsImdyaWRzQ29udGFpbmVyIiwibWFpbiIsInF1ZXJ5U2VsZWN0b3IiLCJncmlkIiwic3RhcnRCdXR0b24iLCJjb29yZHNBcnIiLCJvbmVEaW1lbnNpb25Db29yZHMiLCJmbGF0Q29vcmRzIiwic2hvd1NoaXBzIiwiZGVsZXRlRWxlbWVudHMiLCJyZW1vdmUiLCJFeGFtcGxlQ29vcmRzIiwiZ2VuRE9NIiwic2luZ2xlUGxheWVyIiwibmV3R2FtZSIsInBsYXllck9iaiIsImNwdU9iaiIsInBsYXllciIsInBsYXllcjIiLCJnYW1lVHVybiIsInBsYXllcjJHcmlkIiwidHVybnNMb2dpYyIsInR1cm5Mb29wIiwicGxheWVyMkF0dGFja3NDb3VudCIsImdhbWVUdXJucyIsInNldHVwRE9NIl0sInNvdXJjZVJvb3QiOiIifQ==